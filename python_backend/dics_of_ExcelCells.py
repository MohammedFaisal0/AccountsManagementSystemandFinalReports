class HierarchicalDictionaries:
    def __init__(self):
        self.chapters = {}  # {chapter_id: {"id": str, "name": str, "value": str}}
        self.sections = {}  # {section_id: {"id": str, "name": str, "value": str}}
        self.items = {}     # {item_id: {"id": str, "name": str, "value": str}}
        self.types = {}     # {type_id: {"id": str, "name": str, "value": str}}
    
    def initialize_structure(self, 
                           chapter_data: dict, 
                           section_data: dict, 
                           item_data: dict, 
                           type_data: dict):
        """ุชููุฆุฉ ุงูููุงููุณ ุจูุนุฑูุงุช ูุฃุณูุงุก ูุงุฑุบุฉ"""
        for type_id, type_name in type_data.items():
            self.types[type_id] = {"id": type_id, "name": type_name, "value": ""}
        
        for item_id, item_name in item_data.items():
            self.items[item_id] = {"id": item_id, "name": item_name, "value": "", "type_ids": []}
        
        for section_id, section_name in section_data.items():
            self.sections[section_id] = {"id": section_id, "name": section_name, "value": "", "item_ids": []}
        
        for chapter_id, chapter_name in chapter_data.items():
            self.chapters[chapter_id] = {"id": chapter_id, "name": chapter_name, "value": "", "section_ids": []}
    
    def link_hierarchy(self, 
                      type_to_item: dict, 
                      item_to_section: dict, 
                      section_to_chapter: dict):
        """ุฑุจุท ุงูุนูุงุตุฑ ุงููุฑููุฉ ุจุจุนุถูุง"""
        # 1. ุฑุจุท ุงูุฃููุงุน ุจุงูุจููุฏ
        for item_id, linked_type_ids in type_to_item.items():
            if item_id in self.items:
                self.items[item_id]["type_ids"] = linked_type_ids
        
        # 2. ุฑุจุท ุงูุจููุฏ ุจุงููุตูู
        for section_id, linked_item_ids in item_to_section.items():
            if section_id in self.sections:
                self.sections[section_id]["item_ids"] = linked_item_ids
        
        # 3. ุฑุจุท ุงููุตูู ุจุงูุฃุจูุงุจ
        for chapter_id, linked_section_ids in section_to_chapter.items():
            if chapter_id in self.chapters:
                self.chapters[chapter_id]["section_ids"] = linked_section_ids
    
    def calculate_item_value(self, item_id):
        """Calculate item value based on its types"""
        if item_id not in self.items:
            return 0
        
        type_ids = self.items[item_id]["type_ids"]
        total = 0
        for type_id in type_ids:
            if type_id in self.types:
                try:
                    value = float(self.types[type_id]["value"]) if self.types[type_id]["value"] else 0
                    total += value
                except ValueError:
                    # Handle non-numeric values
                    continue
        return total

    def calculate_section_value(self, section_id):
        """Calculate section value based on its items"""
        if section_id not in self.sections:
            return 0
        
        item_ids = self.sections[section_id]["item_ids"]
        total = 0
        for item_id in item_ids:
            if item_id in self.items:
                try:
                    value = float(self.items[item_id]["value"]) if self.items[item_id]["value"] else 0
                    total += value
                except ValueError:
                    continue
        return total

    def calculate_chapter_value(self, chapter_id):
        """Calculate chapter value based on its sections"""
        if chapter_id not in self.chapters:
            return 0
        
        section_ids = self.chapters[chapter_id]["section_ids"]
        total = 0
        for section_id in section_ids:
            if section_id in self.sections:
                try:
                    value = float(self.sections[section_id]["value"]) if self.sections[section_id]["value"] else 0
                    total += value
                except ValueError:
                    continue
        return total

    def propagate_values(self):
        """Propagate values up the hierarchy from types to chapters"""
        # Calculate items values from types
        for item_id in self.items:
            value = self.calculate_item_value(item_id)
            self.items[item_id]["value"] = str(value)
        
        # Calculate sections values from items
        for section_id in self.sections:
            value = self.calculate_section_value(section_id)
            self.sections[section_id]["value"] = str(value)
        
        # Calculate chapters values from sections
        for chapter_id in self.chapters:
            value = self.calculate_chapter_value(chapter_id)
            self.chapters[chapter_id]["value"] = str(value)

    def update_values(self, value_dict: dict, dict_type: str):
        """ุชุญุฏูุซ ุงูููู ูู ุงููุงููุณ ุงููุญุฏุฏ"""
        target_dict = getattr(self, dict_type, None)
        if not target_dict:
            raise ValueError(f"ููุน ุงููุงููุณ ุบูุฑ ุตุญูุญ: {dict_type}")
        
        for item_id, value in value_dict.items():
            if item_id in target_dict:
                target_dict[item_id]["value"] = value
        
        # Propagate values up the hierarchy after updating
        if dict_type == "types":
            self.propagate_values()
    
    def get_dict(self, dict_type: str) -> dict:
        """ุงุณุชุฑุฌุงุน ูุงููุณ ูุญุฏุฏ"""
        return getattr(self, dict_type, {})
    
    def print_structure(self):
        """ุทุจุงุนุฉ ุงููููู ุงููุฑูู ููุนูุงุตุฑ ุบูุฑ ุงูุตูุฑูุฉ ูุน ุฑุจุท ูู ููุน ุจูุงูู ุงููููู ุงููุฑูู"""
        result = {
            "chapters": [],
            "sections": [],
            "items": [],
            "types": [],
            "hierarchical_rows": []
        }
        # ุจูุงุก ุนูุณ ุงูููุงููุณ ููุฑุจุท
        type_to_item = {}
        for item_id, item in self.items.items():
            for type_id in item.get("type_ids", []):
                type_to_item[type_id] = item_id
        item_to_section = {}
        for section_id, section in self.sections.items():
            for item_id in section.get("item_ids", []):
                item_to_section[item_id] = section_id
        section_to_chapter = {}
        for chapter_id, chapter in self.chapters.items():
            for section_id in chapter.get("section_ids", []):
                section_to_chapter[section_id] = chapter_id
        # ุจูุงุก hierarchical_rows
        for type_id, type_item in self.types.items():
            try:
                value = float(type_item["value"]) if type_item["value"] else 0
                if value != 0:
                    item_id = type_to_item.get(type_id, "")
                    section_id = item_to_section.get(item_id, "")
                    chapter_id = section_to_chapter.get(section_id, "")
                    result["hierarchical_rows"].append({
                        "chapter_id": chapter_id,
                        "section_id": section_id,
                        "item_id": item_id,
                        "type_id": type_id,
                        "name": type_item["name"],
                        "value": type_item["value"]
                    })
            except ValueError:
                continue
        # ุจุงูู ุงููุชุงุฆุฌ ููุง ูู
        for chapter in self.chapters.values():
            try:
                value = float(chapter["value"]) if chapter["value"] else 0
                if value != 0:
                    result["chapters"].append({
                        "id": chapter["id"],
                        "name": chapter["name"],
                        "value": chapter["value"]
                    })
            except ValueError:
                continue
        for section in self.sections.values():
            try:
                value = float(section["value"]) if section["value"] else 0
                if value != 0:
                    result["sections"].append({
                        "id": section["id"],
                        "name": section["name"],
                        "value": section["value"]
                    })
            except ValueError:
                continue
        for item in self.items.values():
            try:
                value = float(item["value"]) if item["value"] else 0
                if value != 0:
                    result["items"].append({
                        "id": item["id"],
                        "name": item["name"],
                        "value": item["value"]
                    })
            except ValueError:
                continue
        for type_item in self.types.values():
            try:
                value = float(type_item["value"]) if type_item["value"] else 0
                if value != 0:
                    result["types"].append({
                        "id": type_item["id"],
                        "name": type_item["name"],
                        "value": type_item["value"]
                    })
            except ValueError:
                continue
        return result

def reading_first_sheet(excel_file_path, sheet_num):
    try:
        from reading_Excel import excel_to_json
        
        print(f"[DEBUG] Starting reading_first_sheet with file: {excel_file_path}, sheet: {sheet_num}")
        
        dict_system = HierarchicalDictionaries()
        
        # Define the hierarchical data with names
        chapter_data = {
            '1_1': 'ุงูุฅูุฑุงุฏุงุช ุงูุถุฑูุจูุฉ',
            '1_2': 'ุงููููููููููููููููููููููููููููููุญ',
            '1_3': 'ุฅูุฑุงุฏุงุช ุฏุฎู ุงูููููุฉ ููุจูุนุงุช ุงูุณูุน ูุงูุฎุฏูุงุช ูุงูุชุญูููุงุช ูุงููุชููุนุฉ',
            '1_4': 'ุงูุชุตุฑู ูู ุงูุฃุตูู ุบูุฑ ุงููุงููุฉ',
            '2_1': 'ุฃุฌูุฑ ูุชุนููุถุงุช ุงูุนุงูููู',
            '2_2': 'ูููุงุช ุนูู ุงูุณูุน ูุงูุฎุฏูุงุช ูุงูููุชููุงุช',
            '2_3': 'ุงูุฅุนุงูุงุช ูุงูููุญ ูุงูููุงูุน ุงูุฅุฌุชูุงุนูุฉ',
            '2_4': 'ุงูุชุตุฑู ูู ุงูุฃุตูู ุบูุฑ ุงููุงููุฉ'
        }

        section_data = {
            '1_11': 'ุงูุฅูุฑุงุฏุงุช ุงูุถุฑูุจูุฉ',
            '1_12': 'ุงูุถุฑุงุฆุจ ุนูู ุงูุฏุฎู ูุงูุฃุฑุจุงุญ ูุงูููุงุณุจ ุงูุฑุฃุณูุงููุฉ',
            '1_13': 'ุงูุถุฑุงุฆุจ ุนูู ุฑูุงุชุจ ูุฃุฌูุฑ ุงูููู ุงูุนุงููุฉ',
            '1_14': 'ุงูุถุฑุงุฆุจ ุนูู ุงูููููุฉ',
            '1_15': 'ุงูุถุฑุงุฆุจ ุนูู ุงูุณูุน ูุงูุฎุฏูุงุช',
            '1_23': 'ุงูุญุตุฉ ูู ุงูููุงุฑุฏ ุงูุนุงูุฉ ุงููุดุชุฑูุฉ',
            '1_31': 'ุฏุฎู ุงูููููุฉ',
            '1_32': 'ุงูุฑุณูู ุงูุฅุฏุงุฑูุฉ',
            '1_33': 'ุฅูุฑุงุฏุงุช ุงูุจุทุงูุงุช ุงูุดุฎุตูุฉ ูุงูุนุงุฆููุฉ',
            '1_34': 'ุงูุบุฑุงูุงุช ูุงูุฌุฒุงุกุงุช ูุงููุตุงุฏุฑุงุช',
            '1_35': 'ุฅูุฑุงุฏุงุช ุฃุฎุฑู ูุชููุนุฉ',
            '1_41': 'ุงูุชุตุฑู ูู ุงูุฃุตูู ุงูุซุงุจุชุฉ',
            '1_43': 'ุงูุชุตุฑู ูู ุงูุฃุตูู ุบูุฑ ุงูููุชุฌุฉ',
            '2_11': 'ุงููุฑุชุจุงุช ูุงูุฃุฌูุฑ ููุง ูู ุญูููุง',
            '2_12': 'ุงููุณุงููุงุช ุงูุฅุฌุชูุงุนูุฉ',
            '2_21': 'ุงูุณูุน ูุงูุฎุฏูุงุช',
            '2_22': 'ูููุงุช ุณูุนูุฉ ูุฎุฏููุฉ ุฃุฎุฑู',
            '2_24': 'ุงุณุชููุงู ุฑุฃุณ ุงููุงู ุงูุซุงุจุช',
            '2_25': 'ูููุงุช ุนูู ุงูููุชููุงุช ุจุฎูุงู ุงูููุงุฆุฏ',
            '2_33': 'ุงูููุงูุน ุงูุฅุฌุชูุงุนูุฉ',
            '2_34': 'ุชุญูููุงุช ูุฅุนุงูุงุช ูุงููุฉ ุฃุฎุฑู',
            '2_41': 'ุงูุชุตุฑู ูู ุงูุฃุตูู ุงูุซุงุจุชุฉ',
            '2_43': 'ุงูุชุตุฑู ูู ุงูุฃุตูู ุบูุฑ ุงูููุชุฌุฉ'
        }

        item_data = {
            '1_111': 'ุงูุฑุงุฏุงุช ุงูุฒูุงุฉ',
            '1_121': 'ุงูุถุฑุงุฆุจ ุนูู ุฏุฎู ุงูุฃูุฑุงุฏ',
            '1_123': 'ุถุฑุงุฆุจ ุฏุฎู ุฃุฎุฑู',
            '1_131': 'ุงูุถุฑุงุฆุจ ุนูู ุฑูุงุชุจ ูุฃุฌูุฑ ุงูููู ุงูุนุงููุฉ',
            '1_143': 'ุงูุถุฑุงุฆุจ ุงููุนุงููุงุช ุงููุงููุฉ ูุงูุฑุฃุณูุงููุฉ',
            '1_151': 'ุงูุถุฑูุจุฉ ุงูุนุงูุฉ ุนูู ูุจูุนุงุช ุงูุณูุน ูุงูุฎุฏูุงุช',
            '1_153': 'ุงูุถุฑุงุฆุจ ุนูู ุงูุฎุฏูุงุช ุงูููุนูุฉ',
            '1_154': 'ุงูุถุฑุงุฆุจ ุนูู ุงุณุชุฎุฏุงู ุงูุณูุน ูุงูุชุฑุงุฎูุต ุจุงุณุชุฎุฏุงููุง ูุชุฃุฏูุฉ ุงูุฃูุดุทุฉ',
            '1_231': 'ุงูุญุตุฉ ูู ุงูููุงุฑุฏ ุงููุดุชุฑูุฉ',
            '1_232': 'ููุญ ุนูููุฉ ุฑุฃุณูุงููุฉ ูู ูุณุชููุงุช ุญููููุฉ ุฃุฎุฑู',
            '1_314': 'ูุจูุนุงุช ุงูุณูุน ูุงูุฎุฏุงูุงุช',
            '1_321': 'ุฑุณูู ุชุฎุทูุท ูุงุณุชุดุงุฑุงุช',
            '1_322': 'ุฑุณูู ุชุฑุงุฎูุต ุงูุจูุงุก ูุชุฌุฏูุฏูุง',
            '1_323': 'ุฅูุฑุงุฏุงุช ุงูุณุฌู ุงูุชุฌุงุฑู ูุงูุตูุงุนู',
            '1_331': 'ุฑุณูู ุงูููุงุฏู ูุงูุฌูุนูุงุช',
            '1_332': 'ุฑุณูู ุฑุฎุต ุญูุงุฒุฉ ุงูุฃุณูุญุฉ',
            '1_341': 'ุงูุฑุงุฏุงุช ุงูุฌุฒุงุกุงุช',
            '1_342': 'ุงูุบุฑุงูุงุช ูุงููุตุงุฏุฑุงุช',
            '1_351': 'ุงูุชุญูููุงุช ุงูุทูุนูุฉ ุจุฎูุงู ุงูููุญ',
            '1_411': 'ูุจูุนุงุช ุงููุจุงูู ูุงูุฅูุดุงุกุงุช',
            '1_412': 'ูุจูุนุงุช ุงููุงูููุงุช ูุงููุนุฏุงุช',
            '1_413': 'ูุจูุนุงุช ุฃุตูู ุซุงุจุชุฉ ุฃุฎุฑู',
            '1_431': 'ูุจูุนุงุช ุงูุฃุฑุงุถู',
            '2_111': 'ุงููุฑุชุจุงุช ุงูุฃุณุงุณูุฉ',
            '2_112': 'ุงููุฑุชุจุงุช ูุงูุฃุฌูุฑ ุงูุชุนุงูุฏูุฉ ูุงููุคูุชุฉ',
            '2_113': 'ุงูููุงูุขุช ูุฃุฌูุฑ ุงูุนูู ุงูุฅุถุงูู',
            '2_114': 'ุงูุจุฏูุงุช',
            '2_115': 'ุงููุฒุงูุง ุงูุนูููุฉ',
            '2_121': 'ูุณุงููุงุช ุงูุถูุงู ุงูุฅุฌุชูุงุนู',
            '2_122': 'ูุณุงููุฉ ุงูุญูููุฉ ูู ูุธู ุงูุฑุนุงูุฉ ุงูุฅุฌุชูุงุนูุฉ',
            '2_123': 'ุงููุณุงููุงุช ุงูุฅุฌุชูุงุนูุฉ ุงููุญุชุณุจุฉ',
            '2_211': 'ุฎุฏูุงุช ุงููุฑุงูู',
            '2_212': 'ูุณุชูุฒูุงุช ุงูููุงุชุจ',
            '2_213': 'ุงูุฅุชุตุงูุงุช',
            '2_214': 'ุงูุถูุงูุฉ',
            '2_215': 'ูููุงุช ุฐุงุช ุทุงุจุน ุฎุงุต',
            '2_216': 'ูููุงุช ุงููุธุงูุฉ',
            '2_217': 'ูููุงุช ุฃุฎุฑู',
            '2_218': 'ููู ูุงูุชูุงูุงุช ุนุงูุฉ',
            '2_221': 'ุฅูุฌุงุฑุงุช ุงูุฃุตูู ุงููููุชุฌุฉ',
            '2_222': 'ูููุงุช ุงูุจุญูุซ ูุงูุชุทููุฑ ูุงูุชุฏุฑูุจ',
            '2_223': 'ุฃุฏููุฉ ููุณุชูุฒูุงุช ุทุจูุฉ ูููุงุฏ ุฃูููุฉ ููุณุงูุฏุฉ',
            '2_241': 'ุงุณุชููุงู ุงููุจุงูู ูุงูุฅูุดุงุกุงุช',
            '2_242': 'ุงุณุชููุงู ุงููุงูููุงุช ูุงููุนุฏุงุช',
            '2_243': 'ุงุณุชููุงู ุฃุตูู ุฑุฃุณูุงููุฉ ุฃุฎุฑู',
            '2_251': 'ุงูุฌุงุฑุงุช ุงูุฃุตูู ุบูุฑ ุงููููุชุฌุฉ',
            '2_332': 'ุงููุณุงุนุฏุงุช ุงูุฅุฌุชูุงุนูุฉ ูุบูุฑ ุงูููุธููู',
            '2_333': 'ุงูููุงูุน ุงูุฅุฌุชูุงุนูุฉ ููููุธููู',
            '2_341': 'ุชุญูููุงุช ูุฅุนุงูุงุช ูุงููุฉ ุฃุฎุฑู',
            '2_345': 'ุงูุชุนููุถุงุช ูุงูุบุฑุงูุงุช ูุงููููุงุช ุงูุทุงุฑุฆุฉ',
            '2_346': 'ุฌููุฉ ุงูุจุงุจ ุงูุฃูู ูุงูุซุงูู ูุงูุซุงูุซ ( ุงูุฅุณุชุฎุฏุงูุงุช ุงูุชุดุบูููุฉ )',
            '2_411': 'ูุจูุนุงุช ุงููุจุงูู ูุงูุฅูุดุงุกุงุช',
            '2_412': 'ูุจูุนุงุช ุงููุงูููุงุช ูุงููุนุฏุงุช',
            '2_413': 'ูุจูุนุงุช ุฃุตูู ุซุงุจุชุฉ ุฃุฎุฑู',
            '2_431': 'ูุจูุนุงุช ุงูุฃุฑุงุถู'
        }

        type_data = {
            '1_1111': 'ุฒูุงุฉ ุงูุญุจูุจ',
            '1_1112': 'ุฒูุงุฉ ุงููุงุช',
            '1_1113': 'ุฒูุงุฉ ุงููุฎุถุฑุงุช',
            '1_1114': 'ุฒูุงุฉ ุงูููุงุดู',
            '1_1115': 'ุฒูุงุฉ ุงูุจุงุทู ุนูู ูุคุณุณุงุช ูุดุฑูุงุช ุงููุทุงุน ุงูุนุงู ูุงููุฎุชูุท',
            '1_1116': 'ุฒูุงุฉ ุงูุจุงุทู ุนูู ุดุฑูุงุช ุงููุทุงุน ุงูุฎุงุต',
            '1_1117': 'ุฒูุงุฉ ุงูุจุงุทู ุนูู ุงูุฃูุฑุงุฏ',
            '1_1118': 'ุฒูุงุฉ ุงููุทุฑุฉ',
            '1_1119': 'ุฃุฎุฑู',
            '1_1214': 'ุงูุถุฑุงุฆุจ ุนูู ุฏุฎู ุงูุฃูุฑุงุฏ',
            '1_1215': 'ุถุฑุงุฆุจ ุฃุฑุจุงุญ ุงูููู ุงูุญุฑุฉ',
            '1_1231': 'ุงูุถุฑูุจุฉ ุนูู ุฑูุน ุงูุนูุงุฑุงุช ูุงูุฃุฑุงุถู',
            '1_1232': 'ุถุฑุงุฆุจ ุฏุฎู ุฃุฎุฑู',
            '1_1311': 'ุงูุถุฑุงุฆุจ ุนูู ุฑูุงุชุจ ูุฃุฌูุฑ ุงูููู ุงูุนุงููุฉ',
            '1_1431': 'ุงูุถุฑุงุฆุจ ุงููุนุงููุงุช ุงููุงููุฉ ูุงูุฑุฃุณูุงููุฉ',
            '1_1432': 'ุฑุณูู ููู ููููุฉ ุงูุฃุฑุงุถู',
            '1_1433': 'ุฑุณูู ููู ููููุฉ ุงูุนูุงุฑุงุช',
            '1_1514': 'ุงูุถุฑูุจุฉ ุงูุนุงูุฉ ุนูู ูุจูุนุงุช ุงูุณูุน ูุงูุฎุฏูุงุช',
            '1_1531': 'ุถุฑูุจุฉ ูุจูุนุงุช ุงููุงุช',
            '1_1532': 'ุงูุถุฑุงุฆุจ ุนูู ุงูุฎุฏูุงุช ุงูููุนูุฉ',
            '1_1534': 'ุถุฑุงุฆุจ ูุจูุนุงุช ุชุฐุงูุฑ ุงูุณูููุง ูุงูููุฏูู ูุงููุงุณูุช ูุงูููุฑุฌุงูุงุช ูุงููุนุงููุงุช ุงูุฑูุงุถูุฉ',
            '1_1542': 'ุงูุฑุณู ุงููุถุงู ุนูู ููุงุชูุฑ ุงูููุฑุจุงุก ูุงูููุงู ูุงูุชูููู',
            '1_1543': 'ุงูุถุฑุงุฆุจ ุนูู ุงุณุชุฎุฏุงู ุงูุณูุน ูุงูุชุฑุงุฎูุต ุจุงุณุชุฎุฏุงููุง ูุชุฃุฏูุฉ ุงูุฃูุดุทุฉ',
            '1_1544': 'ุฑุฎุต ูุณุงุฆู ุงูููู',
            '1_15410': 'ุฑุณูู ูุชุญ ุงููุญูุงุช ุงูุชุฌุงุฑูุฉ',
            '1_15411': 'ุฑุณูู ุชุฑุงุฎูุต ูุฒุงููุฉ ุงูููู ุงููุฎุชููุฉ',
            '1_15412': 'ุฑุณูู ุงูุฏุนุงูุฉ ูุงูุฅุนูุงู',
            '1_15413': 'ุฑุณูู ุฑุฎุต ุงูุฃุนูุงู ุงููููุฉ',
            '1_15415': 'ุงูุฑุงุฏุงุช ุฑุฎุต ูุฒุงููุฉ ูููุฉ ุงูุงุณุชูุฑุงุฏ',
            '1_2311': 'ุงูุญุตุฉ ูู ุงูููุงุฑุฏ ุงููุดุชุฑูุฉ',
            '1_2312': 'ููุญ ุนูููุฉ ุฑุฃุณูุงููุฉ ูู ูุณุชููุงุช ุญููููุฉ ุฃุฎุฑู',
            '1_2313': 'ููุญ ูููุฉ ูุงุณุชุดุงุฑูุฉ',
            '1_2321': 'ูุจูุนุงุช ุงูุณูุน ูุงูุฎุฏุงูุงุช',
            '1_2322': 'ูุจูุนุงุช ุงูููุดุขุช ุงูุณูููุฉ',
            '1_2323': 'ูุจูุนุงุช ุงูุญุงุตูุงุช ุงูุฒุฑุงุนูุฉ',
            '1_2324': 'ูุจูุนุงุช ููุดุขุช ุณูููุฉ ุฃุฎุฑู',
            '1_2325': 'ุงูุฑุณูู ุงูุฅุฏุงุฑูุฉ',
            '1_31411': 'ุฑุณูู ุชุฎุทูุท ูุงุณุชุดุงุฑุงุช',
            '1_31412': 'ุฑุณูู ุชุฑุงุฎูุต ุงูุจูุงุก ูุชุฌุฏูุฏูุง',
            '1_31413': 'ุฅูุฑุงุฏุงุช ุงูุณุฌู ุงูุชุฌุงุฑู ูุงูุตูุงุนู',
            '1_31414': 'ุฑุณูู ุชูุซูู ุงูุนููุฏ',
            '1_3211': 'ุฑุณูู ุงูููุงุฏู ูุงูุฌูุนูุงุช',
            '1_3216': 'ุฑุณูู ุฑุฎุต ุญูุงุฒุฉ ุงูุฃุณูุญุฉ',
            '1_3221': 'ุฑุณูู ุฑูู ูุญูุฑ ุงูุขุจุงุฑ',
            '1_3222': 'ุงูุฑุงุฏุงุช ุฌูุงุฒุงุช ุงูุณูุฑ',
            '1_3223': 'ุฑุณูู ุชุตุงุฑูุญ ุงูุนูู ูุงูุฅูุงูุฉ ูุบูุฑ ุงูููููู ูุชูุฏูุฏุงุชูุง',
            '1_3225': 'ุฑุณูู ุณูุงุญูุฉ',
            '1_3227': 'ุฅูุฑุงุฏุงุช ุงูุจุทุงูุงุช ุงูุดุฎุตูุฉ ูุงูุนุงุฆููุฉ',
            '1_3228': 'ุฑุณูู ุดูุงุฏุงุช ุงูููุงููุฏ ูุงููููุงุช',
            '1_3229': 'ุฑุณูู ุฑุฎุต ุงูููุงุฏุฉ',
            '1_32211': 'ุฑุณูู ุญูุฑ ุงูุจูุงุฑุงุช',
            '1_32212': 'ุฑุณูู ุฅุณุชุฎุฏุงู ุฃุฑุถูุฉ ุงูุฃุณูุงู ุงูุนุงูุฉ ูุงูุฃุฑุถูุฉ',
            '1_32213': 'ุงูุฑุณู ุงููุถุงู ุนูู ุฑุณูู ุฎุฏูุงุช ุงููุณุงูุฎ ูุฃุณูุงู ุงููุญูู ูุงูุฃุณูุงู',
            '1_32215': 'ุฑุณูู ุฅุฏุงุฑูุฉ ุฃุฎุฑู',
            '1_32216': 'ูุจูุนุงุช ุนุฑุถูุฉ ููููุดุขุช ุบูุฑ ุงูุณูููุฉ',
            '1_32217': 'ุฅูุฌุงุฑุงุช ุงููุจุงูู ุงูุญููููุฉ',
            '1_32218': 'ุฅูุฌุงุฑุงุช ุงูุงูุขุช ูุงููุนุฏุงุช',
            '1_32219': 'ุงูุฑุงุฏุงุช ุงูุทุฑูุงุช',
            '1_32220': 'ุฑุณูู ุงุณุชูุงุฑุงุช ูุชุณุฌูู',
            '1_32221': 'ุฑุณูู ุงูุชุญุงูุงุช ูุดูุงุฏุงุช',
            '1_3231': 'ุฑุณูู ูุจูุฏุงุช ูููุงุญุงุช ูุฃุณูุฏุฉ',
            '1_3232': 'ุฅูุฑุงุฏุงุช ุชุฐุงูุฑ ุงููุนุงููุฉ',
            '1_3235': 'ุฅูุฑุงุฏุงุช ูุฎุงุจุฑ ูุฃุดุนุฉ',
            '1_3237': 'ุฅูุฑุงุฏุงุช ุฑููุฏ ูุนูููุงุช',
            '1_3238': 'ุฅูุฑุงุฏุงุช ุดูุงุฏุงุช ุตุญูุฉ',
            '1_32310': 'ุฅูุฑุงุฏุงุช ุงูุญุฌุฑ ุงูุตุญู',
            '1_32311': 'ุฑุณูู ุงููุธุงูุฉ',
            '1_32312': 'ุฑุณูู ุงูุทุฑูุฏ ุงููุงุฑุฏุฉ',
            '1_32313': 'ุฑุณูู ุงููุชุงุญู',
            '1_32314': 'ุฑุณูู ุงูุฅูุชูุงุน ุจููุงูู ุณูุงุฑุงุช ููู ุงูุฑูุงุจ ูุงูุจุถุงุฆุน',
            '1_32315': 'ุงูุฑุณู ุงูููุฑุฑ ุนูู ุญูููุงุช ูุณุงุฆู ููู ุงูุฃุญุฌุงุฑ ูุงูุญุตู ูุงูุฑูู',
            '1_32316': 'ุงูุฑุณู ุงูููุฑุฑ ุนูู ุณูุงุฑุงุช ููู ุงูุฑูุงุจ ุจุฑุงู',
            '1_32317': 'ุงูุฑุณู ุงููุถุงู ุนูู ุงูุฑุณูู ุงูููุฑุฑุฉ ุนูู ุงูุทุฑูุฏ ุงูุจุฑูุฏูุฉ',
            '1_32318': 'ูุจุจุนุงุช ุนุฑุถูุฉ ุฃุฎุฑู ููููุดุขุช ุบูุฑ ุงูุณูููุฉ',
            '1_32319': 'ุงูุบุฑุงูุงุช ูุงูุฌุฒุงุกุงุช ูุงููุตุงุฏุฑุงุช',
            '1_32320': 'ุงูุฑุงุฏุงุช ุงูุฌุฒุงุกุงุช',
            '1_32321': 'ุงูุบุฑุงูุงุช ูุงููุตุงุฏุฑุงุช',
            '1_32322': 'ุงูุบุฑุงูุงุช ูุงููุตุงุฏุฑุงุช (ูุญููุฉ)',
            '1_32323': 'ุงูุบุฑุงูุงุช ูุงููุตุงุฏุฑุงุช ุงููุดุชุฑูุฉ ุงูุฃุฎุฑู',
            '1_3311': 'ุงูุชุญูููุงุช ุงูุทูุนูุฉ ุจุฎูุงู ุงูููุญ',
            '1_3321': 'ุงูุชุญูููุงุช ุงูุทูุนูุฉ ุงูุฌุงุฑูุฉ ุจุฎูุงู ุงูููุญ',
            '1_3324': 'ุงูุชุญูููุงุช ุงูุทูุนูุฉ ุงูุฑุฃุณูุงููุฉ ุจุฎูุงู ุงูููุญ',
            '1_3411': 'ุฅูุฑุงุฏุงุช ุฃุฎุฑู ูุชููุนุฉ',
            '1_3412': 'ุงูุฎุฑุฏุฉ ูุงูููุงูุงุช',
            '1_3421': 'ุชุนููุถุงุช ุฅุชูุงู ููุชููุงุช ุญููููุฉ ุจุฎูุงู ุงููุชุญุตูุงุช ุงููุงุดุฆุฉ ุนู ุฏุนุงูู ูุถุงุฆูุฉ',
            '1_3422': 'ุงููุณุชุฑุฏ ูู ูููุงุช ุงูููุงุฒูุฉ ุนู ุณููู ุณุงุจูุฉ',
            '1_3512': 'ุฅูุฑุงุฏุงุช ูุชููุนุฉ ุฃุฎุฑู',
            '1_3513': 'ุงูุชุตุฑู ูู ุงูุฃุตูู ุบูุฑ ุงููุงููุฉ',
            '1_3514': 'ุงูุชุตุฑู ูู ุงูุฃุตูู ุงูุซุงุจุชุฉ',
            '1_3515': 'ูุจูุนุงุช ุงููุจุงูู ูุงูุฅูุดุงุกุงุช',
            '1_4111': 'ูุจูุนุงุช ุงููุจุงูู ุงูุณูููุฉ',
            '1_4112': 'ูุจูุนุงุช ุงููุจุงูู ุบูุฑ ุงูุณูููุฉ',
            '1_4113': 'ูุจูุนุงุช ุงูุฅูุดุงุกุงุช ุงูุฃุฎุฑู',
            '1_4121': 'ูุจูุนุงุช ุงููุงูููุงุช ูุงููุนุฏุงุช',
            '1_4122': 'ูุจูุนุงุช ุงููุฑูุจุงุช ููุณุงุฆู ุงูููู',
            '1_4123': 'ูุจูุนุงุช ุฃุซุงุซ ููุนุฏุงุช ูุฃุฌูุฒุฉ ุงูููุงุชุจ',
            '1_4131': 'ูุจูุนุงุช ูุงูููุงุช ููุนุฏุงุช ุฃุฎุฑู',
            '1_4132': 'ูุจูุนุงุช ุฃุตูู ุซุงุจุชุฉ ุฃุฎุฑู',
            '1_4133': 'ูุจูุนุงุช ุงูุฃุตูู ุงูุญููุงููุฉ ูุงููุจุงุชูุฉ',
            '1_4311': 'ูุจูุนุงุช ุงูุฃุตูู ุงูุซุงุจุชุฉ ุบูุฑ ุงูููุธูุฑุฉ',
            '1_4312': 'ุฃุฎุฑู',
            '1_4313': 'ุงูุชุตุฑู ูู ุงูุฃุตูู ุบูุฑ ุงูููุชุฌุฉ',
            '1_4314': 'ูุจูุนุงุช ุงูุฃุฑุงุถู',
            '1_4315': 'ูุจูุนุงุช ุฃุฑุงุถู ุฒุฑุงุนูุฉ',
            '2_1111': 'ุงููุฑุชุจุงุช ุงูุฃุณุงุณูุฉ',
            '2_1123': 'ุฃุฌูุฑ ุชุนุงูุฏูุฉ ููุคูุชุฉ',
            '2_1131': 'ุฃุฌูุฑ ุงูุนูู ุงูุฅุถุงูู',
            '2_1132': 'ุงูููุงูุขุช',
            '2_1141': 'ุจุฏู ุทุจูุนุฉ ุงูุนูู',
            '2_1142': 'ุจุฏู ูุธูุฑ',
            '2_1143': 'ุจุฏู ุฑูู',
            '2_1144': 'ุจุฏู ุณูู',
            '2_1145': 'ุจุฏู ุชุญุฏูุซ',
            '2_1151': 'ุงููุฒุงูุง ุงูุนูููุฉ',
            '2_1211': 'ูุณุงููุงุช ุงูุถูุงู ุงูุฅุฌุชูุงุนู',
            '2_1212': 'ูุณุงููุงุช ุงูุญูููุฉ ูู ูุธู ุงูุถูุงู ุงูุฅุฌุชูุงุนู',
            '2_1221': 'ูุณุงููุฉ ุงูุญูููุฉ ูู ูุธู ุงูุฑุนุงูุฉ ุงูุฅุฌุชูุงุนูุฉ',
            '2_1222': 'ุงููุณุงููุงุช ุงูุฅุฌุชูุงุนูุฉ ุงููุญุชุณุจุฉ',
            '2_1231': 'ุงููุณุงููุงุช ุงูุฅุฌุชูุงุนูุฉ ุงููุญุชุณุจุฉ ูู ูุธู ุงูุถูุงู ุงูุฃุฌุชูุงุนู',
            '2_1232': 'ุงููุณุงููุงุช ุงูุฅุฌุชูุงุนูุฉ ุงููุญุชุณุจุฉ ูู ูุธู ุงูุฑุนุงูุฉ ุงูุฅุฌุชูุงุนูุฉ',
            '2_2111': 'ููุงู',
            '2_2112': 'ุฅูุงุฑุฉ',
            '2_2121': 'ุฃุฏูุงุช ูุชุงุจูุฉ ูููุชุจูุฉ ููุชุจ ููุทุจูุนุงุช',
            '2_2131': 'ูุดุฑ ูุฅุนูุงู ููุฌูุงุช ูุฌุฑุงุฆุฏ',
            '2_2132': 'ุงูุจุฑูุฏ ูุงูุฅุชุตุงูุงุช',
            '2_2141': 'ูุคุชูุฑุงุช ูุงุญุชูุงูุงุช ูุถูุงูุฉ',
            '2_2142': 'ูููุงุช ุฐุงุช ุทุงุจุน ุฎุงุต',
            '2_2143': 'ูููุงุช ุงููุธุงูุฉ',
            '2_2144': 'ูููุงุช ุฃุฎุฑู',
            '2_2151': 'ููู ูููุงุช',
            '2_2152': 'ุงูุชูุงูุงุช ุฏุงุฎููุฉ',
            '2_2153': 'ุญุถูุฑ ูุคุชูุฑุงุช ูุงูุชูุงูุงุช ุฎุงุฑุฌูุฉ',
            '2_2161': 'ุฅูุฌุงุฑ ุงููุจุงูู',
            '2_2162': 'ุฅูุฌุงุฑ ุงูุขูุขุช ูุงููุนุฏุงุช ูุงูุฃุฌูุฒุฉ',
            '2_2163': 'ุฅูุฌุงุฑุงุช ุฃุฎุฑู',
            '2_2171': 'ูููุงุช ุงูุจุญูุซ ูุงูุชุทููุฑ',
            '2_2172': 'ูููุงุช ุงูุชุฏุฑูุจ ุงููุญูู',
            '2_2173': 'ูููุงุช ุงูุชุฏุฑูุจ ุงูุฎุงุฑุฌู',
            '2_2181': 'ุฃุฏููุฉ ููุณุชูุฒูุงุช ุทุจูุฉ ูููุงุฏ ุฃูููุฉ ููุณุงูุฏุฉ',
            '2_2182': 'ุฃุบุฐูุฉ ูููุจูุณุงุช',
            '2_2183': 'ูููุงุช ุฃุฎุฑู',
            '2_2211': 'ุตูุงูุฉ ุงูุจููุฉ ุงูุฃุณุงุณูุฉ',
            '2_2212': 'ุตูุงูุฉ ุงูุทุฑู ูุงูุฌุณูุฑ',
            '2_2213': 'ุตูุงูุฉ ุงููุฑุงูู ุงูุนุงูุฉ',
            '2_2221': 'ุตูุงูุฉ ูุจุงูู ูุชุญุณููุงุช ุตุบูุฑุฉ',
            '2_2222': 'ุตูุงูุฉ ุงููุฑูุจุงุช ูุงููุนุฏุงุช ูุงูุฃุซุงุซ',
            '2_2223': 'ูููุฏ ูุฒููุช',
            '2_2231': 'ูุทุน ุบูุงุฑ ูุตูุงูุฉ ูุณุงุฆู ุงูููู',
            '2_2411': 'ุงุณุชููุงู ุงููุจุงูู ุงูุณูููุฉ',
            '2_2412': 'ุงุณุชููุงู ุงููุจุงูู ุบูุฑ ุงูุณูููุฉ',
            '2_2413': 'ุงุณุชููุงู ุงูุฅูุดุงุกุงุช ุงูุฃุฎุฑู',
            '2_2421': 'ุงุณุชููุงู ุงููุงูููุงุช ูุงููุนุฏุงุช',
            '2_2422': 'ุงุณุชููุงู ุงููุฑูุจุงุช ููุณุงุฆู ุงูููู',
            '2_2431': 'ุงุณุชููุงู ุงููุงูููุงุช ูุงููุนุฏุงุช ูุงูุฃุฌูุฒุฉ ุงูุฃุฎุฑู',
            '2_2432': 'ุงุณุชููุงู ุฃุตูู ุฑุฃุณูุงููุฉ ุฃุฎุฑู',
            '2_2433': 'ุงุณุชููุงู ุงูุฃุตูู ุงูุซุงุจุชุฉ ุบูุฑ ุงูููุธูุฑุฉ',
            '2_2511': 'ุงุณุชููุงู ุงูุชุญุณููุงุช ุงููุจูุฑุฉ ููุฃุฑุงุถู',
            '2_2512': 'ุงุณุชููุงู ุฃุตูู ุฑุฃุณูุงููุฉ ุฃุฎุฑู',
            '2_3322': 'ุงููุณุงุนุฏุงุช ุงูุฅุฌุชูุงุนูุฉ ูุบูุฑ ุงูููุธููู',
            '2_3323': 'ุฅุนุงุดุงุช ูุบูุฑ ุงูููุธููู',
            '2_3324': 'ุฅุนุงูุงุช ููุณุงุนุฏุงุช ูุบูุฑ ุงูููุธููู',
            '2_3325': 'ุงูุฅุนุงูุงุช ุงูุดูุฑูุฉ ูุบูุฑ ุงูููุธููู',
            '2_3331': 'ุงููุณุงุนุฏุงุช ุงูุฅุฌุชูุงุนูุฉ ุงูุนูููุฉ ูุบูุฑ ุงูููุธููู',
            '2_3332': 'ุงูููุงูุน ุงูุฅุฌุชูุงุนูุฉ ููููุธููู',
            '2_3333': 'ุชุนููุถุงุช ุฅููุงุก ุงูุฎุฏูุฉ',
            '2_3334': 'ุงูุชุนููุถุงุช ุงูุชู ุชุฏูุน ููููุธู ุฃู ุฃุณุฑุชู ุนูุฏ ุงูุชูุงุนุฏ ุฃู ุงูููุงุฉ ุฃู ุงููููุงุฏ',
            '2_3411': 'ุงูููุงูุน ุงูุฅุฌุชูุงุนูุฉ ุงูุนูููุฉ ููููุธููู',
            '2_3412': 'ููุงูุน ุฅุฌุชูุงุนูุฉ ุฃุฎุฑู ููููุธููู',
            '2_3451': 'ุชุญูููุงุช ูุฅุนุงูุงุช ูุงููุฉ ุฃุฎุฑู',
            '2_3462': 'ุงูุชุนููุถุงุช ูุงูุบุฑุงูุงุช ูุงููููุงุช ุงูุทุงุฑุฆุฉ',
            '2_4111': 'ูุจูุนุงุช ุงููุจุงูู ุงูุณูููุฉ',
            '2_4112': 'ูุจูุนุงุช ุงููุจุงูู ุบูุฑ ุงูุณูููุฉ',
            '2_4113': 'ูุจูุนุงุช ุงูุฅูุดุงุกุงุช ุงูุฃุฎุฑู',
            '2_4121': 'ูุจูุนุงุช ุงููุงูููุงุช ูุงููุนุฏุงุช',
            '2_4122': 'ูุจูุนุงุช ุงููุฑูุจุงุช ููุณุงุฆู ุงูููู',
            '2_4123': 'ูุจูุนุงุช ุฃุซุงุซ ููุนุฏุงุช ูุฃุฌูุฒุฉ ุงูููุงุชุจ',
            '2_4131': 'ูุจูุนุงุช ูุงูููุงุช ููุนุฏุงุช ุฃุฎุฑู',
            '2_4132': 'ูุจูุนุงุช ุฃุตูู ุซุงุจุชุฉ ุฃุฎุฑู',
            '2_4133': 'ูุจูุนุงุช ุงูุฃุตูู ุงูุญููุงููุฉ ูุงููุจุงุชูุฉ',
            '2_4311': 'ูุจูุนุงุช ุงูุฃุตูู ุงูุซุงุจุชุฉ ุบูุฑ ุงูููุธูุฑุฉ',
            '2_4312': 'ุฃุฎุฑู',
            '2_4313': 'ุงูุชุตุฑู ูู ุงูุฃุตูู ุบูุฑ ุงูููุชุฌุฉ',
            '2_4314': 'ูุจูุนุงุช ุงูุฃุฑุงุถู',
            '2_4315': 'ูุจูุนุงุช ุฃุฑุงุถู ุฒุฑุงุนูุฉ'
        }

        print("[DEBUG] Initializing hierarchical structure...")
        dict_system.initialize_structure(chapter_data, section_data, item_data, type_data)
        
        print("[DEBUG] Linking hierarchy...")
        dict_system.link_hierarchy(
            type_to_item={
                '2_111': ['2_1111'],
                '2_112': ['2_1123'],
                '2_113': ['2_1131', '2_1132'],
                '2_114': ['2_1141', '2_1142', '2_1143', '2_1144', '2_1145'],
                '2_115': ['2_1151'],
                '2_121': ['2_1211', '2_1212'],
                '2_122': ['2_1221', '2_1222'],
                '2_123': ['2_1231', '2_1232'],
                '2_211': ['2_2111', '2_2112'],
                '2_212': ['2_2121'],
                '2_213': ['2_2131', '2_2132'],
                '2_214': ['2_2141', '2_2142', '2_2143', '2_2144'],
                '2_215': ['2_2151', '2_2152', '2_2153'],
                '2_216': ['2_2161', '2_2162', '2_2163'],
                '2_217': ['2_2171', '2_2172', '2_2173'],
                '2_218': ['2_2181', '2_2182', '2_2183'],
                '2_221': ['2_2211', '2_2212', '2_2213'],
                '2_222': ['2_2221', '2_2222', '2_2223'],
                '2_223': ['2_2231'],
                '2_241': ['2_2411', '2_2412', '2_2413'],
                '2_242': ['2_2421', '2_2422'],
                '2_243': ['2_2431', '2_2432', '2_2433'],
                '2_251': ['2_2511', '2_2512'],
                '2_332': ['2_3322', '2_3323', '2_3324', '2_3325'],
                '2_333': ['2_3331', '2_3332', '2_3333', '2_3334'],
                '2_341': ['2_3411', '2_3412'],
                '2_345': ['2_3451'],
                '2_346': ['2_3462'],
                '2_411': ['2_4111', '2_4112', '2_4113'],
                '2_412': ['2_4121', '2_4122', '2_4123'],
                '2_413': ['2_4131', '2_4132', '2_4133'],
                '2_431': ['2_4311', '2_4312', '2_4313', '2_4314', '2_4315'],
                '2_434': ['2_4341'],
                '1_111': ['1_1111', '1_1112', '1_1113', '1_1114', '1_1115', '1_1116', '1_1117', '1_1118', '1_1119'],
                '1_121': ['1_1214', '1_1215'],
                '1_123': ['1_1231', '1_1232'],
                '1_131': ['1_1311'],
                '1_143': ['1_1431', '1_1432', '1_1433'],
                '1_151': ['1_1514'],
                '1_153': ['1_1531', '1_1532', '1_1534'],
                '1_154': ['1_1542', '1_1543', '1_1544', '1_15410', '1_15411', '1_15412', '1_15413', '1_15415'],
                '1_231': ['1_2311', '1_2312', '1_2313'],
                '1_232': ['1_2321', '1_2322', '1_2323', '1_2324', '1_2325'],
                '1_314': ['1_31411', '1_31412', '1_31413', '1_31414'],
                '1_321': ['1_3211', '1_3216'],
                '1_322': ['1_3221', '1_3222', '1_3223', '1_3225', '1_3227', '1_3228', '1_3229', '1_32211', '1_32212', '1_32213', '1_32215', '1_32216', '1_32217', '1_32218', '1_32219', '1_32220', '1_32221'],
                '1_323': ['1_3231', '1_3232', '1_3235', '1_3237', '1_3238', '1_32310', '1_32311', '1_32312', '1_32313', '1_32314', '1_32315', '1_32316', '1_32317', '1_32318', '1_32319', '1_32320', '1_32321', '1_32322', '1_32323'],
                '1_331': ['1_3311'],
                '1_332': ['1_3321', '1_3324'],
                '1_341': ['1_3411', '1_3412'],
                '1_342': ['1_3421', '1_3422'],
                '1_351': ['1_3512', '1_3513', '1_3514', '1_3515'],
                '1_411': ['1_4111', '1_4112', '1_4113'],
                '1_412': ['1_4121', '1_4122', '1_4123'],
                '1_413': ['1_4131', '1_4132', '1_4133'],
                '1_431': ['1_4311', '1_4312', '1_4313', '1_4314', '1_4315']
            },
            item_to_section={
                '2_11': ['2_111', '2_112', '2_113', '2_114', '2_115'],
                '2_12': ['2_121', '2_122', '2_123'],
                '2_21': ['2_211', '2_212', '2_213', '2_214', '2_215', '2_216', '2_217', '2_218'],
                '2_22': ['2_221', '2_222', '2_223'],
                '2_24': ['2_241', '2_242', '2_243'],
                '2_25': ['2_251'],
                '2_33': ['2_332', '2_333'],
                '2_34': ['2_341', '2_345', '2_346'],
                '2_41': ['2_411', '2_412', '2_413'],
                '2_43': ['2_431', '2_434'],
                '1_11': ['1_111'],
                '1_12': ['1_121', '1_123'],
                '1_13': ['1_131'],
                '1_14': ['1_143'],
                '1_15': ['1_151', '1_153', '1_154'],
                '1_23': ['1_231', '1_232'],
                '1_31': ['1_314'],
                '1_32': ['1_321', '1_322', '1_323'],
                '1_33': ['1_331', '1_332'],
                '1_34': ['1_341', '1_342'],
                '1_35': ['1_351'],
                '1_41': ['1_411', '1_412', '1_413'],
                '1_43': ['1_431']
            },
            section_to_chapter={
                '1_1': ['1_11', '1_12', '1_13', '1_14', '1_15'],
                '1_2': ['1_23'],
                '1_3': ['1_31', '1_32', '1_33', '1_34', '1_35'],
                '1_4': ['1_41', '1_43'],
                '2_1': ['2_11', '2_12'],
                '2_2': ['2_21', '2_22', '2_24', '2_25'],
                '2_3': ['2_33', '2_34'],
                '2_4': ['2_41', '2_43']
            }
        )
        
        print(f"[DEBUG] Reading Excel file: {excel_file_path}, sheet: {sheet_num}")
        file_path = excel_file_path
        json_result, df_result, type_values = excel_to_json(file_path, sheet_name=sheet_num)
        
        if type_values:
            print("\n๐ ุชุญุฏูุซ ุงูููู ูู ููู Excel...")
            dict_system.update_values(type_values, 'types')
            print("โ ุชู ุงูุชุญุฏูุซ ุจูุฌุงุญ!")
            
            result = dict_system.print_structure()
            print(f"[DEBUG] Processing completed successfully. Result keys: {list(result.keys())}")
            return result
        else:
            print("โ ูุดู ูู ุงุณุชุฎุฑุงุฌ ุงูููู ูู ููู Excel")
            return {
                "chapters": [],
                "sections": [],
                "items": [],
                "types": []
            }
            
    except Exception as e:
        print(f"โ ุฎุทุฃ ูู reading_first_sheet: {str(e)}")
        import traceback
        traceback.print_exc()
        return {
            "chapters": [],
            "sections": [],
            "items": [],
            "types": [],
            "error": str(e)
        }
